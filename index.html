<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tic Tac Toe AI</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0;
    }

    .game-container {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(12px);
      border-radius: 20px;
      padding: 30px;
      width: 340px;
      text-align: center;
      color: #fff;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    }

    h1 {
      margin-bottom: 5px;
    }

    .difficulty {
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 10px;
    }

    .status {
      margin: 10px 0;
      font-size: 18px;
    }

    .board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin: 20px 0;
    }

    .cell {
      height: 90px;
      background: rgba(255,255,255,0.25);
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 42px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.2s ease;
    }

    .cell:hover {
      background: rgba(255,255,255,0.35);
      transform: scale(1.05);
    }

    .cell.taken {
      cursor: not-allowed;
    }

    button {
      padding: 10px 25px;
      border-radius: 30px;
      border: none;
      background: #fff;
      color: #764ba2;
      font-weight: 600;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="game-container">
  <h1>Tic Tac Toe</h1>
  <div class="difficulty" id="difficulty">Difficulty: Easy</div>
  <div class="status" id="status">Your turn (X)</div>

  <div class="board" id="board"></div>

  <button onclick="resetGame()">Restart</button>
</div>

<script>
  const board = document.getElementById("board");
  const statusText = document.getElementById("status");
  const difficultyText = document.getElementById("difficulty");

  let cells = [];
  let boardState = Array(9).fill("");
  let gameActive = true;

  let difficultyLevel = 1; // increases after each player win

  const winCombos = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];

  function createBoard() {
    board.innerHTML = "";
    boardState = Array(9).fill("");
    gameActive = true;
    statusText.textContent = "Your turn (X)";
    
    for (let i = 0; i < 9; i++) {
      const cell = document.createElement("div");
      cell.classList.add("cell");
      cell.addEventListener("click", () => playerMove(i));
      board.appendChild(cell);
    }
    cells = document.querySelectorAll(".cell");
    updateDifficultyText();
  }

  function updateDifficultyText() {
    let label = "Easy";
    if (difficultyLevel === 2) label = "Medium";
    if (difficultyLevel >= 3) label = "Hard";
    difficultyText.textContent = `Difficulty: ${label}`;
  }

  function playerMove(index) {
    if (!gameActive || boardState[index] !== "") return;

    makeMove(index, "X");

    if (checkWin("X")) {
      statusText.textContent = "ðŸŽ‰ You win!";
      difficultyLevel++;
      gameActive = false;
      return;
    }

    if (isDraw()) return;

    statusText.textContent = "AI thinking...";
    setTimeout(aiMove, 500);
  }

  function aiMove() {
    let move;

    if (difficultyLevel === 1) {
      move = randomMove();
    } else if (difficultyLevel === 2) {
      move = smartMove();
    } else {
      move = minimaxMove();
    }

    makeMove(move, "O");

    if (checkWin("O")) {
      statusText.textContent = "ðŸ¤– AI wins!";
      gameActive = false;
      return;
    }

    if (!isDraw()) {
      statusText.textContent = "Your turn (X)";
    }
  }

  function makeMove(index, player) {
    boardState[index] = player;
    cells[index].textContent = player;
    cells[index].classList.add("taken");
  }

  function randomMove() {
    const empty = boardState
      .map((v, i) => v === "" ? i : null)
      .filter(v => v !== null);
    return empty[Math.floor(Math.random() * empty.length)];
  }

  function smartMove() {
    // Try win or block
    for (let p of ["O", "X"]) {
      for (let combo of winCombos) {
        const values = combo.map(i => boardState[i]);
        if (values.filter(v => v === p).length === 2 &&
            values.includes("")) {
          return combo[values.indexOf("")];
        }
      }
    }
    return randomMove();
  }

  function minimaxMove() {
    return minimax(boardState, "O").index;
  }

  function minimax(state, player) {
    const empty = state
      .map((v, i) => v === "" ? i : null)
      .filter(v => v !== null);

    if (checkWinner(state, "X")) return { score: -10 };
    if (checkWinner(state, "O")) return { score: 10 };
    if (empty.length === 0) return { score: 0 };

    let moves = [];

    for (let i of empty) {
      let move = {};
      move.index = i;
      state[i] = player;

      move.score = minimax(state, player === "O" ? "X" : "O").score;
      state[i] = "";
      moves.push(move);
    }

    return player === "O"
      ? moves.reduce((a, b) => a.score > b.score ? a : b)
      : moves.reduce((a, b) => a.score < b.score ? a : b);
  }

  function checkWinner(state, player) {
    return winCombos.some(c =>
      c.every(i => state[i] === player)
    );
  }

  function checkWin(player) {
    return checkWinner(boardState, player);
  }

  function isDraw() {
    if (!boardState.includes("")) {
      statusText.textContent = "ðŸ˜² Draw!";
      gameActive = false;
      return true;
    }
    return false;
  }

  function resetGame() {
    createBoard();
  }

  createBoard();
</script>

</body>
</html>
